<igo-spinner [shown]="spinnerShown"></igo-spinner>

<mat-sidenav-container class="fadq-main-container">

  <igo-backdrop
    [shown]="backdropShown"
    (click)="onBackdropClick()">
  </igo-backdrop>

  <button
    mat-icon-button
    id="menu-button"
    class="fadq-menu-button"
    color="primary"
    tooltip-position="below"
    matTooltipShowDelay="500"
    [matTooltip]="(sidenavOpened ? 'menu.close' : 'menu.open') | translate"
    (click)="onToggleSidenavClick()">
    <mat-icon>
      <ng-container>menu</ng-container>
    </mat-icon>
  </button>

  <fadq-search-bar
    [store]="searchStore"
    (change)="onSearchTermChange($event)">
  </fadq-search-bar>

  <fadq-sidenav
    [ngClass]="{'fadq-sidenav-with-expansion-panel': expansionPanelExpanded}"
    [(opened)]="sidenavOpened"
    [tool]="tool$ | async">
  </fadq-sidenav>

  <igo-map-browser
    igoQuery
    igoMapContext
    igoLayerContext
    igoDropGeoFile
    igoMapBrowserBinding
    [map]="map"
    (query)="onMapQuery($event)">
  </igo-map-browser>
</mat-sidenav-container>

<div class="fadq-footer">
  <fadq-map-actionbar
    [map]="map"
    [mode]="mapActionbarMode"
    [withTitle]="mapActionbarWithTitle">
  </fadq-map-actionbar>
</div>

<fadq-expansion-panel
  [(expanded)]="expansionPanelExpanded"
  [backdropShown]="expansionPanelBackdropShown">

  <ng-container expansionPanelHeader>
    <fadq-editor-selector [store]="editorStore"></fadq-editor-selector>
    <fadq-actionbar
      *ngIf="editor" 
      [store]="editor.actionStore"
      [horizontal]="true"
      [xPosition]="'after'"
      [yPosition]="'above'"
      [overlayClass]="'fadq-expansion-panel-actionbar-overlay'"
      [withToggleButton]="true"
      [withTitle]="actionbarWithTitle"
      [mode]="actionbarMode">
    </fadq-actionbar>
  </ng-container>

  <fadq-entity-table
    *ngIf="editor"
    class="table-compact table-centered"
    [store]="editor.entityStore"
    [template]="editor.tableTemplate">
  </fadq-entity-table>

</fadq-expansion-panel>

<fadq-toast-panel
  [title]="toastPanelTitle"
  [withHeader]="toastPanelContent === 'feature'"
  [(opened)]="toastPanelOpened">

  <igo-feature-details
    *ngIf="toastPanelContent === 'feature'"
    [feature]="feature">
  </igo-feature-details>

  <fadq-editor-outlet
    *ngIf="toastPanelContent === 'editor'"
    [editor]="editor"
    (deactivateWidget)="onDeactivateEditorWidget()">
  </fadq-editor-outlet>

</fadq-toast-panel>
