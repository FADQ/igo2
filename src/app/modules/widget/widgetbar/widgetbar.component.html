<mat-list *ngIf="!collapsed">

  <fadq-widgetbar-item
    *ngIf="withToggleButton"
    color="accent"
    [ngClass]="getWidgetClass(toggleWidget)"
    [withTitle]="false"
    [withIcon]="true"
    [widget]="toggleWidget"
    (activate)="onToggle()">
  </fadq-widgetbar-item>

  <ng-template
    *ngIf="visible"
    ngFor let-widget [ngForOf]="store.entities">
    <fadq-widgetbar-item
      color="accent"
      [ngClass]="getWidgetClass(widget)"
      [withTitle]="withTitle"
      [withIcon]="withIcon"
      [disabled]="widgetIsDisabled(widget)"
      [widget]="widget"
      (activate)="onActivateWidget(widget)">
    </fadq-widgetbar-item>
  </ng-template>
</mat-list>

<div *ngIf="collapsed">
  <button
    mat-icon-button
    [matMenuTriggerFor]="widgetbarMenu">
    <mat-icon>more_horiz</mat-icon>
  </button>

  <mat-menu
    #widgetbarMenu="matMenu"
    class="fadq-compact-menu fadq-no-min-width-menu"
    overlapTrigger="true"
    [xPosition]="xPosition"
    [yPosition]="yPosition"
    [class]="overlayClass">

    <mat-list>
      <ng-template ngFor let-widget [ngForOf]="store.entities">
        <fadq-widgetbar-item
          color="accent"
          [ngClass]="getWidgetClass(widget)"
          [withTitle]="withTitle"
          [withIcon]="withIcon"
          [disabled]="widgetIsDisabled(widget)"
          [widget]="widget"
          (activate)="onActivateWidget(widget)">
        </fadq-widgetbar-item>
      </ng-template>
    </mat-list>
  </mat-menu>
</div>
